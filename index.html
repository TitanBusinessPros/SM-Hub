<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Social Media Hub Maker â€” Fixed Links</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;800&display=swap" rel="stylesheet">
<style>
  :root { --bg1:#071227; --bg2:#0b1930; --accent1:#7c3aed; --accent2:#06b6d4; --muted:rgba(255,255,255,0.78); }
  *{box-sizing:border-box} html,body{height:100%}
  body{margin:0;font-family:"Poppins",system-ui,Segoe UI,Roboto,Arial;background:linear-gradient(120deg,var(--bg1),var(--bg2));color:#fff;padding:28px;display:flex;justify-content:center;}
  .wrap{max-width:1100px;width:100%;display:grid;grid-template-columns:1fr 440px;gap:22px;align-items:start}
  .panel{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:20px;border-radius:14px;border:1px solid rgba(255,255,255,0.03);box-shadow:0 12px 36px rgba(2,6,23,0.6)}
  h1{margin:6px 0 10px;font-weight:800;font-size:18px}
  label{display:block;margin-top:12px;font-size:13px;color:var(--muted)}
  input,textarea,select{width:100%;padding:10px;margin-top:8px;border-radius:10px;border:none;background:rgba(255,255,255,0.03);color:#fff;font-size:14px;outline:none;resize:vertical}
  .btns{display:flex;gap:10px;margin-top:14px}
  button{padding:10px 12px;border-radius:10px;border:0;cursor:pointer;font-weight:700}
  .primary{background:linear-gradient(90deg,var(--accent1),var(--accent2));color:#fff}
  .ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted)}
  .preview{display:flex;align-items:center;justify-content:center}
  .card{width:100%;max-width:420px;padding:20px;border-radius:14px;text-align:center;background:linear-gradient(180deg, rgba(255,255,255,0.025), rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.03);box-shadow:0 12px 36px rgba(2,6,23,0.6)}
  .avatar{width:86px;height:86px;border-radius:16px;margin:0 auto 12px;display:grid;place-items:center;font-size:30px;font-weight:800;background:linear-gradient(135deg,var(--accent1),var(--accent2));box-shadow:0 8px 22px rgba(7,10,29,0.5)}
  .name{font-weight:800;font-size:20px}
  .bio{color:var(--muted);font-size:13px;margin:6px 0 16px;word-break:break-word;white-space:normal}
  .links{display:flex;flex-direction:column;gap:10px;align-items:stretch}
  .link{display:flex;align-items:center;justify-content:space-between;padding:12px;border-radius:12px;background:rgba(255,255,255,0.03);color:#fff;text-decoration:none;border:1px solid rgba(255,255,255,0.03)}
  .link .left{display:flex;gap:12px;align-items:center}
  .pill{width:46px;height:46px;border-radius:10px;display:grid;place-items:center;font-weight:800;background:linear-gradient(135deg,var(--accent1),var(--accent2))}
  .title{font-weight:700}
  .subtitle{font-size:12px;color:var(--muted);margin-top:4px;word-break:break-all}
  .small{font-size:12px;color:var(--muted);margin-top:8px}
  #sourceArea{display:none;width:100%;height:240px;margin-top:12px;padding:10px;border-radius:10px;background:rgba(0,0,0,0.06);font-family:monospace;font-size:12px;overflow:auto;color:#fff;border:1px solid rgba(255,255,255,0.03);white-space:pre-wrap}
  @media (max-width:980px){.wrap{grid-template-columns:1fr}.preview{order:-1;margin-bottom:12px}}
</style>
</head>
<body>
  <div class="wrap" role="main">
    <section class="panel" aria-label="Builder panel">
      <h1>Social Media Hub Maker â€” fixed link handling</h1>
      <p class="small">Enter one link per line. Formats accepted: <code>Service | URL</code> or just <code>URL</code>. Missing protocols (like <code>https://</code>) will be auto-added when appropriate.</p>

      <label for="initialsInput">Initials</label>
      <input id="initialsInput" type="text" maxlength="4" value="AB" />

      <label for="nameInput">Display name</label>
      <input id="nameInput" type="text" value="Alex Bright" />

      <label for="bioInput">Bio</label>
      <textarea id="bioInput" rows="2">Creator &amp; curious human â€” building things.</textarea>

      <label for="linksInput">Links (one per line)</label>
      <textarea id="linksInput" rows="8" placeholder="Website | https://example.com
twitter.com/yourname
mailto:you@example.com">https://google.com
github.com
mailto:hello@example.com
twitter.com/yourname</textarea>

      <div class="btns">
        <button class="primary" id="generateBtn">Generate</button>
        <button class="ghost" id="downloadBtn">Download HTML</button>
        <button class="ghost" id="copyBtn">Copy HTML</button>
      </div>

      <div id="sourceArea" aria-hidden="true"></div>
      <div class="small">If download is blocked, use Copy HTML then paste into a file and save as <code>yourname_hub.html</code>.</div>
    </section>

    <aside class="preview">
      <div class="card" id="previewCard" aria-live="polite">
        <div class="avatar" id="pvInitials">AB</div>
        <div class="name" id="pvName">Alex Bright</div>
        <div class="bio" id="pvBio">Creator &amp; curious human â€” building things.</div>
        <div class="links" id="pvLinks"></div>
      </div>
    </aside>
  </div>

<script>
/* Escapers for safe HTML insertion */
function textEscape(s){ return String(s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }
function attrEscape(s){ return String(s||'').replace(/&/g,'&amp;').replace(/"/g,'&quot;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

/* Normalize URL: ensure protocol when appropriate */
function normalizeUrl(u){
  if(!u) return '';
  u = u.trim();
  // already has explicit scheme or protocol-relative
  if(/^(https?:|mailto:|tel:|\/\/)/i.test(u)) return u;
  // starts with www.
  if(/^www\./i.test(u)) return 'https://' + u;
  // contains a dot and no spaces => assume it's a domain/path => add https
  if(/\./.test(u) && !/\s/.test(u)) return 'https://' + u;
  // otherwise return as-is (could be a relative link or something else)
  return u;
}

/* Parse lines: Service | URL OR just URL */
function parseLines(text){
  const rows = String(text||'').split(/\r?\n/).map(r=>r.trim()).filter(Boolean);
  const out = [];
  for(const r of rows){
    // split on first '|'
    const idx = r.indexOf('|');
    let left = '', right = '';
    if(idx >= 0){
      left = r.slice(0, idx).trim();
      right = r.slice(idx+1).trim();
    } else {
      left = r;
      right = '';
    }

    // if right is empty and left looks like URL -> treat left as URL
    const looksLikeUrl = s => /^(https?:\/\/|mailto:|tel:|\/\/)/i.test(s) || (/\./.test(s) && !/\s/.test(s));
    let title = left, url = right;
    if(!url && looksLikeUrl(left)){
      url = left; 
      // make reasonable title from hostname
      try {
        const u = new URL( normalizeUrl(url).startsWith('http') ? normalizeUrl(url) : 'https://'+url );
        title = u.hostname.replace(/^www\./,'');
      } catch(e){
        title = left;
      }
    } else if(url && !title){
      title = url;
    }

    url = normalizeUrl(url || '');
    if(title && url) out.push({title: title, url: url});
  }
  return out;
}

/* Build preview UI */
function buildPreview(){
  const initials = (document.getElementById('initialsInput').value || '??').toUpperCase().slice(0,4);
  const name = document.getElementById('nameInput').value || 'Unnamed';
  const bio = document.getElementById('bioInput').value || '';
  const raw = document.getElementById('linksInput').value || '';

  const parsed = parseLines(raw);

  document.getElementById('pvInitials').textContent = initials;
  document.getElementById('pvName').textContent = name;
  document.getElementById('pvBio').textContent = bio;

  const container = document.getElementById('pvLinks');
  container.innerHTML = '';
  if(parsed.length === 0){
    const no = document.createElement('div'); no.className = 'subtitle'; no.textContent = 'No links entered yet.'; container.appendChild(no);
  } else {
    parsed.forEach(it=>{
      const a = document.createElement('a');
      a.className = 'link';
      a.href = it.url;
      a.target = '_blank';
      a.rel = 'noopener noreferrer';
      // inner structure
      const left = document.createElement('div'); left.className = 'left';
      const pill = document.createElement('div'); pill.className = 'pill'; pill.textContent = (it.title||'')[0] ? it.title.slice(0,2).toUpperCase() : 'ðŸ”—';
      const titWrap = document.createElement('div');
      const tit = document.createElement('div'); tit.className = 'title'; tit.innerHTML = textEscape(it.title);
      const sub = document.createElement('div'); sub.className = 'subtitle'; sub.innerHTML = textEscape(it.url);
      titWrap.appendChild(tit); titWrap.appendChild(sub);
      left.appendChild(pill); left.appendChild(titWrap);
      a.appendChild(left);
      const arrow = document.createElement('div'); arrow.style.opacity = '.9'; arrow.style.fontWeight = '700'; arrow.textContent = 'âž”';
      a.appendChild(arrow);
      container.appendChild(a);
    });
  }
}

/* Build final HTML string for download or copy */
function buildExportHtml(){
  const initials = textEscape((document.getElementById('initialsInput').value || '??').toUpperCase().slice(0,4));
  const name = textEscape(document.getElementById('nameInput').value || 'Unnamed');
  const bio = textEscape(document.getElementById('bioInput').value || '');
  const parsed = parseLines(document.getElementById('linksInput').value || '');

  // links markup
  const linksHtml = parsed.map(it=>{
    const t = textEscape(it.title);
    const u = attrEscape(it.url); // safe for attribute
    return `<a class="link" href="${u}" target="_blank" rel="noopener noreferrer">
      <div class="left">
        <div class="pill">${t.slice(0,2).toUpperCase()}</div>
        <div class="title-wrap">
          <div class="title">${t}</div>
          <div class="sub">${textEscape(it.url)}</div>
        </div>
      </div>
      <div style="opacity:.9;font-weight:700">âž”</div>
    </a>`;
  }).join("\n      ");

  const full = `<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>${name} â€” Links</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;800&display=swap" rel="stylesheet">
<style>
  *{box-sizing:border-box}html,body{height:100%}
  body{margin:0;font-family:Poppins,system-ui,Segoe UI,Roboto,Arial;background:linear-gradient(120deg,#071227,#0b1930);color:#fff;display:flex;align-items:center;justify-content:center;padding:30px}
  .card{width:100%;max-width:480px;border-radius:14px;padding:24px;text-align:center;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.03);box-shadow:0 12px 36px rgba(2,6,23,0.6)}
  .avatar{width:86px;height:86px;border-radius:16px;margin:0 auto 12px;display:grid;place-items:center;font-size:30px;font-weight:800;background:linear-gradient(135deg,var(--accent1,#7c3aed),var(--accent2,#06b6d4));box-shadow:0 8px 22px rgba(7,10,29,0.5)}
  h1{margin:6px 0 0;font-size:20px}
  p.bio{color:rgba(255,255,255,0.85);font-size:14px;margin:8px 0 16px;word-break:break-word}
  .links{display:flex;flex-direction:column;gap:10px;align-items:stretch}
  .link{display:flex;align-items:center;justify-content:space-between;padding:12px;border-radius:12px;background:rgba(255,255,255,0.03);color:#fff;text-decoration:none;border:1px solid rgba(255,255,255,0.03)}
  .pill{width:46px;height:46px;border-radius:10px;display:grid;place-items:center;font-weight:800;background:linear-gradient(135deg,#7c3aed,#06b6d4)}
  .title{font-weight:700}
  .sub{font-size:12px;color:rgba(255,255,255,0.78);margin-top:4px;word-break:break-all}
  @media (max-width:520px){body{padding:18px}.card{padding:18px}}
</style>
</head>
<body>
  <div class="card">
    <div class="avatar">${initials}</div>
    <h1>${name}</h1>
    <p class="bio">${bio}</p>
    <div class="links">
      ${linksHtml}
    </div>
  </div>
</body>
</html>`;

  return full;
}

/* Download with Blob (and fallback to source area) */
function downloadHtml(){
  const html = buildExportHtml();
  try {
    const blob = new Blob([html], {type:'text/html'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    const fname = (document.getElementById('nameInput').value || 'my_hub').replace(/\s+/g,'_') + '_hub.html';
    a.download = fname;
    document.body.appendChild(a);
    a.click();
    a.remove();
    URL.revokeObjectURL(url);
    document.getElementById('sourceArea').style.display = 'none';
    alert('Download attempted. If your browser blocked it, use Copy HTML to save manually.');
  } catch(e){
    showSource(html);
  }
}

/* Copy to clipboard fallback */
async function copyHtml(){
  const html = buildExportHtml();
  try {
    if(navigator.clipboard && navigator.clipboard.writeText){
      await navigator.clipboard.writeText(html);
      alert('HTML copied to clipboard. Paste into a file and save with .html extension.');
      document.getElementById('sourceArea').style.display = 'none';
    } else {
      showSource(html);
      alert('Clipboard not available â€” HTML shown below for manual copy.');
    }
  } catch(e){
    showSource(html);
    alert('Copy failed â€” HTML shown below for manual copy.');
  }
}

function showSource(src){
  const area = document.getElementById('sourceArea');
  area.style.display = 'block';
  area.textContent = src;
  area.scrollTop = 0;
}

/* Events */
document.getElementById('generateBtn').addEventListener('click', buildPreview);
document.getElementById('downloadBtn').addEventListener('click', ()=>{
  buildPreview();
  downloadHtml();
});
document.getElementById('copyBtn').addEventListener('click', ()=>{
  buildPreview();
  copyHtml();
});

/* Live debounce preview */
let t;
['initialsInput','nameInput','bioInput','linksInput'].forEach(id=>{
  document.getElementById(id).addEventListener('input', ()=>{
    clearTimeout(t);
    t = setTimeout(buildPreview, 180);
  });
});

/* initial render */
buildPreview();
</script>
</body>
</html>
